<!DOCTYPE html>
<html>
    <head>
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
        <link  rel="stylesheet" href="drag.css" />
    </head>

<body >
        <div id="name"></div>
        
        <div class="file-upload">
                <div class="file-select">
                  <div class="file-select-button" id="fileName">Choose File</div>
                  <div class="file-select-name" id="noFile">No file chosen...</div> 
                 
    <form id="upload-file" method="post" enctype="multipart/form-data">
          <input type="file" name="chooseFile" id="chooseFile">
          
  </form>
</div>
</div>
<button id="upload-file-btn" type="button">Upload</button>
  <script>
 var d=document.getElementById("name");
d.innerHTML="Upload  " + sessionStorage.getItem("assignment");


$(function() {
    var form_data = new FormData($('#upload-file')[0]);
    console.log(form_data)
    
    $('#chooseFile').bind('change', function () {
  var filename = $("#chooseFile").val();
  if (/^\s*$/.test(filename)) {
    $(".file-upload").removeClass('active');
    $("#noFile").text("No file chosen..."); 
  }
  else {
    $(".file-upload").addClass('active');
    $("#noFile").text(filename.replace("C:\\fakepath\\", "")); 
  }
});


    $('#upload-file-btn').click(function() {
        var form_data = new FormData($('#upload-file')[0]);
        console.log(form_data)
        $.ajax({
            type: 'POST',
            url: 'http:127.0.0.1:5000/api/v1/upload/'+sessionStorage.getItem('assignment')+'/'+sessionStorage.getItem("name"),
            data: form_data,
            contentType: false,
            cache: false,
            processData: false,
            success: function(data) {
                alert('Success!');
                $.ajax({
            url: 'http://127.0.0.1:5000/api/v1/change_assignment/'+sessionStorage.getItem("name"),
            type: 'POST',
            data: {'assignment_name':sessionStorage.getItem('assignment')},
            
            success: function(data) {
              
            },
            error: function(data) {
            //  document.getElementById("error-login").innerHTML=data.responseText;
            //  document.getElementById("error-login").style.color="red";
            }
        });
        //sleep(2000)
        window.location.href="student.html"
            },
            error: function(data) {
              alert(data.responseText)
            }
        });
    });
});
  </script>
</body>
</html>